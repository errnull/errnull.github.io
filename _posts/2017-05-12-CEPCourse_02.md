---
layout: post
title: 一份来自 iOS🙈 的零基础 After Effects CEP 教程 -- [ 2 ] Hello World
date: 2017-05-14 
tags:  Adobe-CEP   
---
闲话不说，配置完环境后，我们先创建一个能跑起来的项目，然后再对项目目录进行解释吧！
<br><br>

### 开始 Hello World ！！！

　

#### 1.建立项目目录

我们先创建一个文件夹，名称随意，为了宿主应用启动时加载，它需要被放在指定目录:

```
OS X：         /Library/Application Support/Adobe/CEP/extensions/
Windows 32 位：C:\Program Files\Common Files\Adobe\CEP\extensions\
Windows 64 位：C:\Program Files (x86)\Common Files\Adobe\CEP\extensions\
```

![](/images/posts/jekyll/2016-05-20-jll-01.jpg)

项目中必要的文件有：
![](/images/posts/jekyll/2016-05-20-jll-01.jpg)
你可以根据自己的需求去扩展这个目录
<br><br><br>


#### 2.创建 manifest.xml 配置文件

manifest.xml 是一个 XML 格式的配置文件，里面有我们这个扩展的配置信息，包括扩展名称、版本、在什么宿主中运行、入口文件、尺寸等等等配置，后面我们还会详细介绍 manifest.xml。

我们在扩展工作目录中建立一个名为 CSXS 的文件夹，并在其中新建一个文本并命名为 manifest.xml ，并输入以下内容，保存为 UTF-8 编码：

```
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<ExtensionManifest xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" ExtensionBundleId="com.nullice.helloworld" ExtensionBundleVersion="1.0" Version="6.0"> <!-- MAJOR-VERSION-UPDATE-MARKER -->
    <ExtensionList>
        <Extension Id="com.nullice.helloworld" Version="1.0"/> <!-- 设置扩展 ID-->
    </ExtensionList>

    <ExecutionEnvironment>
        <HostList> <!-- 设置扩展能在 11.0 版本之后 PhotoShop 中运行-->
            <Host Name="PHXS" Version="[11.0,99.9]"/>
            <Host Name="PHSP" Version="[11.0,99.9]"/>
        </HostList>

        <LocaleList>
            <Locale Code="All"/>
        </LocaleList>

        <RequiredRuntimeList>
            <RequiredRuntime Name="CSXS" Version="6.0"/> 
        </RequiredRuntimeList>
    </ExecutionEnvironment>

    <DispatchInfoList>
        <Extension Id="com.nullice.helloworld"> <!-- 为 com.nullice.helloworld 设置属性-->
            <DispatchInfo>
                <Resources>
                    <MainPath>./index.html</MainPath> <!-- 指定起始载入的网页-->
                    <ScriptPath>./jsx/main.jsx</ScriptPath> <!-- 指定用到的 JSX 文件-->
                </Resources>

                <Lifecycle>
                    <AutoVisible>true</AutoVisible> <!-- 设置扩展面板为可视-->
                    <StartOn>
                    </StartOn>
                </Lifecycle>

                <UI>
                    <Type>Panel</Type> <!-- 设置扩展显示为面板模式-->
                    <Menu>Hello world</Menu> <!-- 设置扩展标题-->
                    <Geometry>
                        <Size>  <!-- 设置扩展面板尺寸-->
                            <Height>300</Height>
                            <Width>300</Width>
                        </Size>
                        <MaxSize>
                            <Height>900</Height>
                            <Width>900</Width>
                        </MaxSize>
                        <MinSize>
                            <Height>300</Height>
                            <Width>300</Width>
                        </MinSize>
                    </Geometry>
                    <Icons>  <!-- 设置扩展面板尺寸-->
                        <Icon Type="Normal">./img/icon1.png</Icon>
                        <Icon Type="DarkNormal">./img/icon1.png</Icon>
                    </Icons>
                </UI>

            </DispatchInfo>
        </Extension>
    </DispatchInfoList>
</ExtensionManifest>

```
<br><br>


#### 3.创建 HTML 页面

CEP 的用户界面使用的是 HTML ，也就是网页，在 manifest.xml 中定义了扩展的入口 HTML 文件。

在工作目录根目录建立一个文本命名为 index.html  ，填入下面内容，保存为 UTF-8 编码：

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
  <head>
  <meta http-equiv="content-type" content="text/html" charset="UTF-8">
  <link href="./css/styles.css" type="text/css" rel="stylesheet">
      <script type="text/javascript" src="./js/test.js"></script>
      <script type="text/javascript" src="./js/CSInterface.js"></script>
      <script type="text/javascript" src="./js/Vulcan.js"></script>
      <script type="text/javascript" src="./js/AgoraLib.js"></script>
  </head>

  <body style="background-color: #a2a1a3; text-align: center;" >
  <span style="font-family: '微软雅黑'; font-style: normal; font-weight: normal; font-size: 16pt; color: white"> CEP 6 开发教程 </span>
    <br>
    <br>
    <br>
    <span >
      <span style="font-family: 'Castellar'; font-style: normal; font-weight: normal; font-size: 34pt;"> Hello World ! </span>
    </span>
  <br>

  <input type="button" value="新建文档" onclick="pop()">

  </body>
</html>
```
<br><br>



#### 4.扩展其他目录

在 HTML 文件中我们引入了一个 Javascript 文件，在工作目录根目录建立一个名为 js 的文件夹，并在其中新建文本 test.js ，填入下面内容，保存为 UTF-8 编码：

```
var pop = function ()
{
    var cs = new CSInterface();
    cs.evalScript("dodo()");
}
```

![](/images/posts/jekyll/2016-05-20-jll-01.jpg)
HTML 中给一个按钮绑定了 test.js 中的一个方法 pop() 这个方法会实现一个简单的功能：在 PhotoShop 中新建一个文档。为了实现这个功能我们还需要一个执行ExtendScript 的 JSX 文件。
运行在 CEP VM 中的 JavaScript 无法直接调用 PhotoShop 的功能，所以我们会用 CSInterface.js 最为桥梁调用 JSX 。我们在 HTML 文件中已经引用了 CSInterface.js 。 CSInterface.js 需要放入你的工作目录中，它是 Adobe 官方发布的可以从官方获取。

可以看到我们在 JavaScript 中调用了 dodo() 方法（cs.evalScript("dodo()")），这个方法的实现在 manifest.xml 中定义的 jsx/main.jsx 文件 。（实际上也可以直接在 JavaScript 中写 cs.evalScript(" app.documents.add()"); 来实现）
在工作目录根目录建立一个名为 jsx 的文件夹，并在其中新建文本 main.jsx ，填入下面内容，保存为 UTF-8 编码：

```
var dodo = function (info)
{
    app.documents.add();// 新建一个文档
}
```



